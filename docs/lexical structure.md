## 词法结构

### 输入格式

Sheet 会把源代码文件解释为以 UTF-16 编码的 Unicode 字符流。目的是可以直接使用 Java 中的`char`类型操作源代码。

### 标识符（identifiers）

一个合法的标识符具有以下性质：

* 非空
* 非保留字（关键字）
* 第一个字符必须为英文字母、美元符号（`$`）或者下划线
* 第一个字符以后的字符必须为阿拉伯数字、英文字母、美元符号（`$`）或者下划线

### 注释（comments）

为方便起见，沿用 C++ 风格的注释。

单行注释以两条斜线（double slash，即`//`）开始，直到这一行的行尾。

多行注释以`/*`开始，以`*/`结束，并且可以嵌套。

### 空白字符（whitespace）

以下字符被定义为空白字符：

* `U+0020` (空格，`' '`)
* `U+0009` (横向制表符，`'\t'`)
* `U+000A` (换行，`'\n'`)
* `U+000D` (回车，`'\r'`)

空白字符串为仅有空白字符的字符串，空白字符（串）只用于分割词法单元，没有任何语义。

### 字面量（literals）

字面量指不可继续求值的表达式，它的值就是它本身。

#### 字符及字符串字面值

##### 字符

字符字面量是用两个英文单引号（`U+0027`，即`'`）包围的除了英文单引号的单个 Unicode 字符或转义序列。

##### 字符串

字符串字面量是由两个英文双引号（`U+0022`，即`"`）包围的，由除了英文双引号的 Unicode 字符或转义序列构成的序列。

字符串字面量中允许插入换行符。但是如果跟在一个反斜杠（`U+005C`，即`\`）之后，则仅作为代码中的换行，反斜杠、回车符和下一行行首的所有空白字符都不会作为该字符串字面量的内容。

比如，下边两个字符串是等价的：

```
"foobarqux"
"foo\
     barqux"
```

##### 转义序列（escapee sequence）

转义序列是以反斜杠（`U+005C`，即`\`）开始和紧随其后的转义字符（串）构成的，用以表示无法直接输入的字符或者可能带来歧义的字符。

有以下几种转义字符（串）：

* 8 位的字符码位，以拉丁字母`x`（`U+0078`）开始和紧随其后的恰好两个十六进制数字（大小写不限）组成，表示该十六进制码位对应的字符
* 24 位的字符码位，以拉丁字母`u`（`U+0075`）开始和紧随其后的，由左花括号（`U+007B`）和右花括号（`U+007D`）包围的至多六个十六进制数字（大小写不限）组成，表示该十六进制码位对应的 Unicode 字符
* 拉丁字母`n`（`U+006E`）、`r`（`U+0072`）或`t`（`U+0074`），分别代表换行符（`U+000A`）、回车（`U+000D`）和制表符（`U+0009`）
* 反斜杠自己，用于表示一个反斜杠字符

#### 数字字面值

##### 整数

整数字面量有四种形式：

* 十进制整数以十进制数字开始，后面跟着多个十进制数字或下划线
* 十六进制整数以`0x`开始，后面跟着多个十六进制数字或下划线
* 八进制整数以`0o`开始，后面跟着多个八进制数字或下划线
* 二进制整数以`0b`开始，后面跟着多个二进制数字或下划线

整数可以以整数格式后缀为结尾，用于表示特定类型的整数。

##### 浮点数

浮点数由四个部分依次组成：

1. 整数部分，由一个可选的符号开始，后边跟着多个十进制数字或下划线
2. 英文句点（`U+002E`，即`.`）
3. 小数部分，由多个十进制数字或下划线组成
4. 指数部分，以一个大写或小写的`e`开始，跟着一个可选的符号，符号后边是多个十进制数字或下划线

第 1 部分与 2 和 3 部分可以一起依次出现，也可以分别出现（也就是说，它们的出现是「逻辑或」的关系）。第 4 部分是可选的。

浮点数可以以浮点数格式后缀结尾，用于表示特定类型的浮点数。

##### 数字格式后缀

数字可以以数字格式后缀结尾，用于指定数字以特定类型存储。

数字的存储类型是以以下方式决定的：

1. 如果在上下文中指定了类型，按照上下文中的指定的类型存储
2. 如果有数字格式后缀，则按照其指定的类型存储
3. 如果没有数字格式后缀，整数以 32 位有符号整数类型存储，浮点数以 64 位浮点数存储 

有以下几种数字格式后缀：

1. 整数：`u8`、`u16`、`u32`、`u64`、`i8`、`i16`、`i32`和`i64`
2. 浮点数：`f32`和`f64`

##### 示例

```
0b0000_1111_0000_1111	// 32-bit binary signed integer
0o765_432u64				// 64-bit octal unsigned inetegr
1234567i32				// 32-bit decimal signed integer
0xCAFEu16					// 16-bit hexidecimal unsigned integer
3.1415926					// 64-bit floating-point number
0.1f32						// 32-bit floating-point number
12E+99_f64				// 64-bit floating-point number
```

**注：下划线在数字中没有实际意义，仅作分隔符以提高可读性。**

#### 布尔

布尔（boolean）类型只有两个字面值，分别为`true`和`false`。

### 关键词（keywords）

以下标识符被保留作为关键词：

`// to be completed`

### 标点（punctuators）

标点是在源代码中不携带语法内涵的符号。

`// to be completed`

### 运算符（operators）

运算符在语法上执行运算。

`// to be completed`

### 词法单元的正则表达式表述

1. 标识符：`[a-zA-Z_$][a-zA-Z0-9_$]*`
2. 单行注释：`//.*$`
3. 多行注释：有嵌套，无法用正则表达式描述
4. 整数：`((:dec:)|(:oct:)|(:bin:)|(:hex:))(:intsuf:)?`
4. 十进制整数`(:dec:)`：`\d+`
5. 八进制整数`(:oct:)`：`0o[0-7]+`
6. 二进制整数`(:bin:)`：`0b[01]+`
7. 十六进制整数`(:hex:)`：`0x[\dA-Fa-f]+`
8. 整数格式后缀`(:intsuf:)`：`u8|u16|u32|u64|i8|i16|i32|i64`
9. 浮点数：`[+-]?(\d+)(\.\d+)([Ee][+-]?(\d+))?(f32|f64)`
10. 布尔：`true|false`